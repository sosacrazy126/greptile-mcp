build:
  dockerfile: Dockerfile.smithery

startCommand:
  type: http
  port: 8080
  configSchema:
    type: object
    required:
      - greptileApiKey
      - githubToken
    properties:
      greptileApiKey:
        type: string
        description: "API key for accessing the Greptile API"
      githubToken:
        type: string
        description: "GitHub Personal Access Token for repository access"
      greptileBaseUrl:
        type: string
        description: "Custom Greptile API base URL"
        default: "https://api.greptile.com/v2"
  commandFunction: |
    (config) => ({
      command: 'python',
      args: ['-m', 'src.smithery_server'],
      env: {
        GREPTILE_API_KEY: config.greptileApiKey,
        GITHUB_TOKEN: config.githubToken,
        GREPTILE_BASE_URL: config.greptileBaseUrl || "https://api.greptile.com/v2",
        PORT: "8080"
      }
    })
